<!--
	This is an example widget for the tweak XenInfo
-->
<!DOCTYPE html>
<html>
<head>
	<meta content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
	<style>
		body{
			color:white; font-size: 20px;
			background-color: black;
			font-family: helvetica;
			font-size: 12px;
		}
		#artwork{
			width:100px;
			height: 100px;
			background-size: cover;
			background-position: center;
			background-color: black;
			background-image:url('ArtworkDefault.jpg');
			display: none;
		}
		.container{
			position: relative;
			margin-top: 100px;
		}
		label{
			font-size: 10px;
			color:rgba(255,255,255,0.5);
		}
	</style>
</head>
<body>
	<div class="container">
		<label>Statusbar Info</label>
		<div id="statusbarDiv">ATAT</div>
		<label>Battery Info</label>
		<div id="batteryDiv">ATAT</div>
		<label>Reminder Info</label>
		<div id="remindersDiv">Reminders</div>
		<label>Event Info</label>
		<div id="eventsDiv">Events</div>
		<label>Weather Info</label>
		<div id="weatherDiv">Weather</div>
		<label>Music Info</label>
		<div id="musicDiv"></div>
		<div id="artwork"></div>
		<label>App Info</label>
		<div id="apps">test</div>
	</div>

	<script type="text/javascript" src="clock.js"></script> <!-- Clock is only used to translate in this example -->
	<script type="text/javascript">

		/*
			we are changing these divs often, lets cache them in a variable to use later
			without needing to look it up by getElementByID every time
		*/

		var doc = document,
			statusbarDiv = doc.getElementById('statusbarDiv'),
			batteryDiv = doc.getElementById('batteryDiv'),
			remindersDiv = doc.getElementById('remindersDiv'),
			eventsDiv = doc.getElementById('eventsDiv'),
			weatherDiv = doc.getElementById('weatherDiv'),
			musicDiv = doc.getElementById('musicDiv'),
			artworkDiv = doc.getElementById('artwork');

		/*
			This function is called from the tweak XenInfo. It will call the function when somthing updates.
			Which means there is no need for an interval or setTimeout to randomly check if the battery needs updated.
			Instead it will update whenever the battery or music changes. You can see this by watching the charge div
			as you unplug and plug in your device. It will change immediately.
		*/

		function mainUpdate(type){

			if(type == "statusbar"){ //statusbar info

				statusbarDiv.innerHTML =  "SignalBars:" + signalBars + " SignalName:" + signalName + " WifiStrength: " + wifiStrength + " WifiName: " + wifiName + " WifiBars: " + wifiBars;

			}else if(type == "battery"){ //battery info

				var chargeText = (batteryCharging) ? "Charging" : "Not Charging";

				batteryDiv.innerHTML = "Percent: " + batteryPercent + " Charging: " + chargeText + " ramFree: " + ramFree + " ramUsed: " + ramUsed + " ramAvailable: " + Math.abs(ramAvailable) + " ramPhysical: " + Math.abs(ramPhysical);

			}else if(type == "reminders"){ //reminder info

				if(reminders.length > 0){
					remindersDiv.innerHTML = ''; //clear old reminders
					for (var i = 0; i < reminders.length; i++) {
						remindersDiv.innerHTML += reminders[i].title + "</br>";
					}
				}else{
					remindersDiv.innerHTML = "No Reminders";
				}

			}else if(type == "events"){ //events info

				if(events.length > 0){
					eventsDiv.innerHTML = ''; //clear old events
					eventsDiv.innerHTML = events[0].title + " " + events[0].date;
				}else{
					eventsDiv.innerHTML = "No Events";
				}

			}else if(type == "music"){ //music info

				if(isplaying){ //will say if music is playing or not

					musicDiv.innerHTML = "Artist: " + artist + " Album: " + album + " Title: " + title + " NowPlaying: YES";

					var milli = new Date().getMilliseconds(),
					url = "/var/mobile/Documents/Artwork.jpg?" + milli;
				    artworkDiv.style.backgroundImage = "url('" + url + "')";
				    artworkDiv.style.display = "block";

				}else{

					musicDiv.innerHTML = "Artist: NA" + " Album: NA" +  " Title: NA" + " NowPlaying: NO";
					artworkDiv.style.backgroundImage = "url('ArtworkDefault.jpg')";
					artworkDiv.style.display = "none";

				}

			}else if (type == "weather"){ //weather info

				weatherDiv.innerHTML = "Temp: " + weather.temperature + " FeelsLike: " + weather.feelsLike +  " Updated: " + weather.updateTimeString + " City: " + weather.city + " LOW: " + weather.low + " HIGH: " + weather.high + " Rain: " + weather.chanceofrain + "%" + " WindChill: " + weather.windChill + " WindSpeed: " + weather.windSpeed + " WindDir: " + weather.windDirection;

			}else if(type == "signinginfo"){ //signing info

				var info = JSON.parse(signedInfo),
				holder = document.getElementById('apps'),
				el;
				holder.innerHTML = "";
				for (var i = 0; i < info.length; i++) {
					var split = info[i].split('-'),
						name = split[0],
						date = new Date (parseInt(split[1]));

					el = document.createElement('div');
					el.innerHTML = name + ": Expires on " + translate[current].smonth[date.getMonth()] + " " + translate[current].sday[date.getDay()] + " " + date.getDate();
					holder.appendChild(el);
				};
			}

		}
	</script>
</body>
</html>